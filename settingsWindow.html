<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="import" href="https://rawgit.com/sitepoint-editors/multiselect-web-component/master/src/multiselect.html">
    <link rel="stylesheet" href="./styles/settings.css">
    <title></title>
</head>

<body>
    <div>
        <div id="container">
            <x-multiselect id="projects-multiselect" placeholder="Select Value"></x-multiselect>
            <button id="projects-from-template">U</button>
        </div>
    </div>
    <div>
        <label>Path:</label>
        <input type="text"></input>
    </div>
    <div>
        <label>Realtime:</label>
        <input type="checkbox">
        <input> |
        <label>Top:</label>
        <input type="checkbox">
        <input> |
        <label>Black Theme:</label>
        <input type="checkbox">
        <input>
    </div>
    <div>
        Showtime:
        <input type="text"></input>
        :
        <input type="text"></input>
    </div>
    <div>
        Worktime:
        <input type="text"></input>
    </div>
</body>

<script>
    const electron = require('electron');
    const $ = require('jquery');
    const { ipcRenderer } = electron;
    let multiselect;
    let uploadProjectsButton;

    function onUploadProjectsButtonClicked(e) {
        e.preventDefault();
        ipcRenderer.send('settings:uploadProjects', {});
    }

    function presentProjects(projects) {
        for (const project of projects) {
            const li = document.createElement("li");
            li.innerText = project.name;
            if (project.enabled) {
                var selectedAttribute = document.createAttribute("selected");
                selectedAttribute.value = "selected";
                li.setAttributeNode(selectedAttribute);
            }
            multiselect.appendChild(li);
        }
    }

    ipcRenderer.on('projects:reset', (e, projects) => {
        $(multiselect).children('li').remove();
        presentProjects(projects);
    });

    ipcRenderer.on('settings:present', (e, settings) => {
        presentProjects(settings.projects);
    });

    $(() => {
        multiselect = document.querySelector('x-multiselect');
        multiselect.addEventListener('change', function () {
            console.log('Selected items:', this.selectedItems());
        });

        uploadProjectsButton = document.querySelector('#projects-from-template');
        uploadProjectsButton.addEventListener('click', onUploadProjectsButtonClicked);

        ipcRenderer.send('settings:opened', {});
    });

</script>

</html>